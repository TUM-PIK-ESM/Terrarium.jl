var documenterSearchIndex = {"docs":
[{"location":"overview/software_architecture/#Software-architecture","page":"Software architecture","title":"Software architecture","text":"","category":"section"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"warning: üößüöß Under construction üößüöß\nThe architecture of Terra.jl is still in an early prototype stage and is the subject of ongoing discussion. This page is a non-exhaustive summary of the current working concept and will be updated accordingly if and when the architecture changes.","category":"page"},{"location":"overview/software_architecture/#Numerical-implementation","page":"Software architecture","title":"Numerical implementation","text":"","category":"section"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"Terra is based on the numerics and finite-volume method operators provided by Oceananigans.jl. All state variables are represented as Oceananigans Fields with computations automatically distributed using KernelAbstractions.jl. Spatial grids in Terra are similarly based on the corresponding Oceananigans grids, most prominently the RectilinearGrid which represents a rectangular volume divided orthogonally into smaller control volumes along the X, Y, and Z dimensions.","category":"page"},{"location":"overview/software_architecture/#The-AbstractModel-interface","page":"Software architecture","title":"The AbstractModel interface","text":"","category":"section"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"A ‚Äúmodel‚Äù in Terra represents a collection of parameters and process types that characterize a simulation. All models must be defined as structs that subtype AbstractModel and will typically consist of the following fields/properties:","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"A grid that defines the discretization of the spatial domain\nAn initializer responsible for initializing state variables\nOne or more processes and/or sub-models that define the state variables and the dynamics of the system","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"The distinction between what constitutes a ‚Äúmodel‚Äù versus a ‚Äúprocess‚Äù should be based on whether or not there is a use case for running simulations of that model/process independently from other processes. Models should be built to be independently runnable standalone in a Simulation, while process types simply provide the concrete implementations of the physical processes to be included in a model. Since Terra models are composable, it should generally be trivial to convert a process into a full standalone model later (if necessary) without affecting the other model components that depend on it.","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"All AbstractModel and AbstractLandProcess types must additional provide dispatches for the following methods:","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"variables(::Model) returns a tuple of variable metadata declaring the state variables. Variables must be one of two types: prognostic or auxiliary (sometimes referred to as ‚Äúdiagnostic‚Äù). Prognostic variables fully characterize the state of the system at any given timestep and are updated according to their tendencies (i.e. G in the aforementioned equation). Tendencies are automatically allocated for each prognostic variable declared by the model.\ncompute_auxiliary!(state, ::Model) computes the values of all auxiliary variables (if necessary) assuming that the prognostic variables of the system in state are available for the current timestep.\ncompute_tendencies!(state, ::Model) computes the tendencies based on the current values of the prognostic and auxiliary variables stored in state.","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"In addition, AbstractModel  implementations must also provide dispatches for the following methods:","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"initialize!(state, ::Model, ::Initializer) computes any necessary initialization of the model state based on the user-supplied configuration and parameter settings. The additional initializer argument is extracted from the model and allows for alternative dispatches based on various initialization schemes for each model.\ntimestep!(state, ::Model, ::TimeStepper, dt) updates the prognostic state variables according to the given timestepping scheme. This method can and should be implemented generically for any timestepping scheme but allows for model-specific overrides where necessary.\nget_grid(::Model) returns the spatial grid associated with the model. A default implementation is provided which assumes that the model defines a field named grid.\nget_initializer(::Model) returns the initializer for the model. A default implementation is provided which assumes that the model defines a field named initializer.","category":"page"},{"location":"overview/software_architecture/#State-variables","page":"Software architecture","title":"State variables","text":"","category":"section"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"State variables are realized as Oceananigans Fields defined over the model grid. Each variable returned by the variables method will be allocated a corresponding Field with boundary conditions and initial values specified by one or more AbstractInitializers defined on the model. This allocation occurs when creating a Simulation by calling  initialize(model). The resulting Simulation object will have a property state of type StateVariables which holds all of the Fields for each state variable defined by the model.","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"As an example, suppose we are implementing a new model MyModel and we want to define the necessary state variables. We do this by defining a new dispatch of the variables method:","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"variables(::MyModel) = (\n\tprognostic(:progvar, XYZ()),\n\tauxiliary(:auxvar, XYZ()),\n\tauxiliary(:bc, XY()),\n)","category":"page"},{"location":"overview/software_architecture/","page":"Software architecture","title":"Software architecture","text":"This will result in a total of four state variables being allocated when initialize(model) is called: two auxiliary variables named auxvar and bc as well as one prognostic variable named progvar along with its tendency progvar_tendency which is created automatically. The second argument to the variable metadata constructors prognostic and auxiliary is a subtype of VarDims which specifies on which spatial dimensions the state variable should be defined. XYZ() corresponds to a 3D Field which is discretized both laterally (along spatial grid cells) and along the vertical axis. Currently, Terra only supports a single 3D grid representing variables defined in the soil domain, though this may change in the near future in order to accommodate multi-layer snow and canopy processes. XY() corresponds to a 2D field which is discretized along the lateral dimension only. Note that Terra also currently supports only 1D (vertical) dynamics so all grid cells on the X and Y axes will be assumed independent. This is equivalent to what is typically called a single column model, or column-based parameterization in atmosphere and ocean modeling. However, building on Oceananigans means that we have a clear path to relax this assumption in the future!","category":"page"},{"location":"physics/soil_energy_water/#Soil-hydrothermal-dynamics","page":"Energy and water balance","title":"Soil hydrothermal dynamics","text":"","category":"section"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"warning: Warning\nThis page is a work in progress. If you have any questions or notice any errors, please raise an issue.","category":"page"},{"location":"physics/soil_energy_water/#Heat-transfer","page":"Energy and water balance","title":"Heat transfer","text":"","category":"section"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"Heat transfer along the vertical axis perpendicular to the land surface can be represented according to the heat equation, with the upper boundary set to surface temperature and the lower boundary set to a constant positive heat flux representing heat produced by the inner earth (Lachenbruch 1986, Jaeger 1965). If both the upper and lower boundaries are assumed to be constant over time, the steady-state temperature profile takes the form of a continuous piecewise linear function increasing over depth with the slope determined by the thermal properties of the ground material. The instantaneous temperature field can then be generally represented as","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\nT(zt) = T_0 + fracQ_textgeokappa_texth(z)z + Delta T(zt)\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where T(zt) is the temperature field (K) over depth z (m) and time t (s), T_0 is the mean annual GST (K), Q_textgeo is the geothermal heat flux (W/m¬≤), and kappa_texth(z) (W/m K) is the thermal conductivity which may vary with depth depending on the material. The last term Delta T(zt) represents transient disturbances to the steady state temperature profile due to both seasonal and long-term fluctuations in the upper and lower boundary conditions of the vertical domain. Simulating the impacts of these transient changes is one of the primary objectives of most numerical permafrost and land surface models.","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"Diffusive heat flow in a solid medium is governed by Fourier's law,","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\n    mathbfj_texth cdot mathbfn_z = -kappa_texthfracpartial Tpartial z\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where mathbfj_texth (W/m¬≤) is the diffusive heat flux vector and mathbfn_z is the upward facing normal vector along the vertical z axis.","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"Since ground materials are often porous, i.e., there exists void space between the solid particles, it is necessary to consider the potential presence of water and/or ice in this void space, which is hereafter referred to as pore space, or simply, soil pores. The thermal effects of water and ice can be accounted for by considering not only the temperature of the material but rather the total internal energy of the elementary volume. Combining the diffusive flux with a potential advective heat flux j_z^textw due to water flow yields the energy conservation law,","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\nfracpartial U(Ttheta)partial t - nabla cdot mathbfj_texth + mathbfj_h^textw - F_h(zt) = 0\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where U(Ttheta) (J/m¬≥) is the volumetric internal energy as a function of temperature and total water/ice content theta (m¬≥/m¬≥), and F_h(zt) is an inhomogeneous heat source/sink (forcing) term.","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"The advective heat flux j_texth^textw can be represented as,","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\nmathbfj_texth^textw = left( c_textw T + L_textsl right) mathbfj_textw rho_textw\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where L_textsl and c_textw (J/kg) represent the specific latent heat of fusion and heat capacity of liquid water respectively. This flux term accounts for the energy transferred by the movement of water within the soil matrix. In model configurations that neglect subsurface water flow, this flux term is implicitly assumed to be zero.","category":"page"},{"location":"physics/soil_energy_water/#Energy-temperature-closure","page":"Energy and water balance","title":"Energy-temperature closure","text":"","category":"section"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"The constitutive relationship between energy and temperature plays a key role in characterizing the subsurface energy balance. This relation can be defined in integral form as","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\n    U(Ttheta) = int_T_textref^T tildeC(xtheta)  dx\n    = overbraceHC(thetawthetai)leftT-T_textrefright^textSensible + overbracedensityw LHFthetaw(Tthetawi)^textLatent\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where tildeC is referred to as the effective or apparent heat capacity and T_textref is a reference temperature. The apparent heat capacity is then defined as the derivative of the energ-temperature relation,","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\ntildeC(Ttheta) = fracpartial Upartial T =\noverbraceC(theta_textwtheta) + T fracpartial Cpartial theta_textwfracpartial theta_textwpartial T^textSensible +\noverbracerho_textw L_textsl fracpartialtheta_textwpartial T^textLatent\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where theta_textw(Ttheta) is the volumetric unfrozen water content as a function of temperature and total water/ice content is the bulk volumetric material heat capacity of the volume as a function of the unfrozen and total water contents;  rho_textw (kg/m¬≥) and L_textsl (J/kg) correspond to the density and specific latent heat of fusion of water, respectively. The grouping of terms on the right-hand side show the partitioning of energy change into sensible and latent heat. The sensible component represents the energy necessary to heat a volume of the material to a particular temperature, whereas the latent component corresponds to the energy required for the phase change of water in the volume from solid (frozen) to liquid (thawed).","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"In the simplest case where we neglect the effect of capillary action in the soil, the energy-temperature relation can be derived according to that of \"free\" water (i.e. unbound by the soil matrix),","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\n    theta_textw(U) =\n        begincases\n            0                    U  rho_textwL_textsltheta \n            fracUL  -rho_textwL_textsltheta leq U  0 \n            theta               U  0\n        endcases\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"with temperature then determined by","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\n    U^-1(U(Ttheta)) =\n    begincases\n    frac(U(Ttheta) - L_ftheta)C    U(Ttheta)  rho_textwL_textsltheta \n    0  0 leq U(Ttheta) leq rho_textwL_textsltheta \n    fracU(Ttheta)C    U(Ttheta)  0\n    endcases\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where C = C(theta_textwtheta) is the volumetric heat capacity (J/K/m¬≥).","category":"page"},{"location":"physics/soil_energy_water/#Vertical-water-transport-in-variably-saturated-soil","page":"Energy and water balance","title":"Vertical water transport in variably saturated soil","text":"","category":"section"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"The vertical flow of water in porous media, such as soils, can be formulated as following the conservation law","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"    phifracpartialvartheta(psi)partial t - nabla cdot textbfj_textw - F_textw(zt) = 0","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where phi is the natural porosity (or saturated water content) of the soil volume and F_textw(zt) (m/s) is an inhomogeneous source/sink (forcing) term.","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"Vertical fluxes in the soil column be represented by combining gravity-driven advection with Darcy's law","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"beginequation\ntextbfj_textw cdot mathbfn = -kappa_textwfracpartial left(psi + zright)partial z\nendequation","category":"page"},{"location":"physics/soil_energy_water/","page":"Energy and water balance","title":"Energy and water balance","text":"where psi (m) is the matric potential. Substituting this equation into the aforementioned conservation law yields the widely known Richardson-Richards equation for variably saturated flow in porous media (Richards 1931).","category":"page"},{"location":"api_reference/#API-Reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"api_reference/#Terra.AbstractBulkWeightingScheme","page":"API Reference","title":"Terra.AbstractBulkWeightingScheme","text":"Base type for bulk weighting/mixing schemes that calculate weighted mixture of material properties such as conductivities or densities.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractClosureRelation","page":"API Reference","title":"Terra.AbstractClosureRelation","text":"abstract type AbstractClosureRelation\n\nBase type for prognostic variable closure relations for differential equations of the form:\n\nfracpartial g(u)partial t = F(u)\n\nwhere F represents the RHS tendency as a function of the state variable u, and g(u) is a closure or constitutive relation that maps u to the physical units matching the tendency. Common examples in soil hydrothermal modeling are temperature-enthalpy and saturation-pressure relations.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractEnergyBalanceModel","page":"API Reference","title":"Terra.AbstractEnergyBalanceModel","text":"abstract type AbstractEnergyBalanceModel{NF} <: Terra.AbstractModel{NF}\n\nBase type for surface energy balance models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractGroundModel","page":"API Reference","title":"Terra.AbstractGroundModel","text":"abstract type AbstractGroundModel{NF} <: Terra.AbstractModel{NF}\n\nBase type for ground (e.g. soil and rock) models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractHydrologyModel","page":"API Reference","title":"Terra.AbstractHydrologyModel","text":"abstract type AbstractHydrologyModel{NF} <: Terra.AbstractModel{NF}\n\nBase type for surface hydrology models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractLandModel","page":"API Reference","title":"Terra.AbstractLandModel","text":"AbstractLandModel <: AbstractModel\n\nBase type for full land models which couple together multiple component models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractLandProcess","page":"API Reference","title":"Terra.AbstractLandProcess","text":"AbstractLandProcess{NF}\n\nBase type for all land processes which define physics or parameterizations but are not standalone models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractModel","page":"API Reference","title":"Terra.AbstractModel","text":"abstract type AbstractModel{NF}\n\nBase type for all models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractSnowModel","page":"API Reference","title":"Terra.AbstractSnowModel","text":"abstract type AbstractSnowModel{NF} <: Terra.AbstractModel{NF}\n\nBase type for snow models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractSoilModel","page":"API Reference","title":"Terra.AbstractSoilModel","text":"abstract type AbstractSoilModel{NF} <: Terra.AbstractGroundModel{NF}\n\nBase type for soil ground models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractTimeStepperCache","page":"API Reference","title":"Terra.AbstractTimeStepperCache","text":"Base type for time-stepper state caches.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractVariable","page":"API Reference","title":"Terra.AbstractVariable","text":"abstract type AbstractVariable\n\nBase type for state variable specification.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AbstractVegetationModel","page":"API Reference","title":"Terra.AbstractVegetationModel","text":"abstract type AbstractVegetationModel{NF} <: Terra.AbstractModel{NF}\n\nBase type for vegetation/carbon models.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.AuxiliaryVariable","page":"API Reference","title":"Terra.AuxiliaryVariable","text":"AuxiliaryVariable{VD<:VarDims} <: AbstractVariable\n\nRepresents an auxiliary (sometimes called \"diagnostic\") variable with the given name and dims on the spatial grid.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.ColumnGrid","page":"API Reference","title":"Terra.ColumnGrid","text":"ColumnGrid{NF,RectGrid<:Grids.RectilinearGrid} <: AbstractLandGrid\n\nRepresents a set of laterally independent vertical columns with dimensions (x, y, z) where x is the column dimension, y=1 is constant, and z is the vertical axis.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.ConstantSoilCarbonDenisty","page":"API Reference","title":"Terra.ConstantSoilCarbonDenisty","text":"ConstantSoilCarbonDenisty{NF} <: AbstractSoilBiogeochemistry\n\nNaive implementation of soil biogeochemistry that just assumes there to be a constant organic content in all soil layers.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.FieldInitializers","page":"API Reference","title":"Terra.FieldInitializers","text":"struct FieldInitializers{VarInits<:NamedTuple} <: Terra.AbstractInitializer\n\nInitializer type that allows for direct specification of Field initializer functions.\n\nExample:\n\ninitializer = FieldInitializers(:temperature => )\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.FieldInitializers-Tuple{}","page":"API Reference","title":"Terra.FieldInitializers","text":"FieldInitializers(; vars...)\n\nCreates a FieldInitializers for the given variables. The first value of the pair is the name of the state variable while the second value should be a Function or callable struct of the form f(x,y,z)::Real where z is the vertical coordinate, decreasing with depth.\n\nExample:\n\ninitializer = FieldInitializers(\n    temperature = (x,y,z) -> 0.01*abs(z) + exp(z)*sin(2œÄ*z)\n)\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.ForwardEuler","page":"API Reference","title":"Terra.ForwardEuler","text":"Simple forward Euler time stepping scheme.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.GlobalRingGrid","page":"API Reference","title":"Terra.GlobalRingGrid","text":"struct GlobalRingGrid{NF, RingGrid<:SpeedyWeather.RingGrids.AbstractGrid, RectGrid<:Oceananigans.Grids.AbstractGrid} <: Terra.AbstractLandGrid{NF}\n\nConvenience wrapper around ColumnGrid that defines the columns as points on a global RingGrid.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.HomogeneousSoil","page":"API Reference","title":"Terra.HomogeneousSoil","text":"struct HomogeneousSoil{NF} <: Terra.AbstractStratigraphy{NF}\n\nRepresents a soil stratigraphy of well mixed material with homogeneous soil texture.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.InverseQuadratic","page":"API Reference","title":"Terra.InverseQuadratic","text":"The inverse quadratic (or \"quadratic parallel\") bulk thermal conductivity formula (Cosenza et al. 2003):\n\nk = sum_i=1^N Œ∏·µ¢sqrtk·µ¢^2\n\nCosenza, P., Gu√©rin, R., and Tabbagh, A.: Relationship between thermal conductivity and water content of soils using numerical modelling, European Journal of Soil Science, 54, 581‚Äì588, https://doi.org/10.1046/j.1365-2389.2003.00539.x, 2003.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.LUEPhotosynthesis","page":"API Reference","title":"Terra.LUEPhotosynthesis","text":"struct LUEPhotosynthesis{NF} <: Terra.AbstractPhotosynthesis\n\nPhotosynthesis implementation from PALADYN (Willeit 2016) for C3 PFTs following the general light use efficiency model described in Haxeltine and Prentice 1996.\n\nAuthors: Maha Badri and Matteo Willeit\n\nProperties:\n\nœÑ25::Any: Value of œÑ at 25¬∞C\nKc25::Any: Value of Kc at 25¬∞C\nKo25::Any: Value of Ko at 25¬∞C\nq10_œÑ::Any: q10 for temperature-sensitive parameter œÑ\nq10_Kc::Any: q10 for temperature-sensitive parameter Kc\nq10_Ko::Any: q10 for temperature-sensitive parameter Ko\nŒ±_leaf::Any: Leaf albedo in PAR range [-]\ncq::Any: Conversion factor for solar radiation at 550 nm from J/m¬≤ to mol/m¬≤ [mol/J]\nk_ext::Any: Extinction coefficient for radiation through vegetation [-]\nŒ±_a::Any: Fraction of PAR assimilated at ecosystem level, relative to leaf level [-]\nt_CO2_high::Any: Parameter, PFT specific [¬∞C]\nt_CO2_low::Any: Parameter, PFT specific [¬∞C]\nt_photos_high::Any: Parameter, PFT specific [¬∞C]\nt_photos_low::Any: Parameter, PFT specific [¬∞C]\nŒ±_C3::Any: Intrinsic quantum efficiency of CO2 uptake in C3 plants [mol/mol]\nC_mass::Any: Atomic mass of carbon [gC/mol]\nŒ∏_r::Any: Shape parameter [-]\nday_length::Any: Day length [h/day]\nsec_day::Any: Seconds per day [s/day]\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.MedlynStomatalConductance","page":"API Reference","title":"Terra.MedlynStomatalConductance","text":"struct MedlynStomatalConductance{NF} <: Terra.AbstractStomatalConductance\n\nStomatal conductance implementation from PALADYN (Willeit 2016) following the optimal stomatal conductance model (Medlyn et al. 2011).\n\nAuthors: Maha Badri and Matteo Willeit\n\nProperties:\n\ng1::Any: Parameter in optimal stomatal conductance formulation, Lin et al. 2015 [-], PFT specific\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.Namespace","page":"API Reference","title":"Terra.Namespace","text":"Namespace <: AbstractVariable\n\nRepresents a new variable namespace, typically from a subcomponent of the model. It is (currently) assumed that tha name of the namesapce corresponds to a property defined on the model type.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.PALADYNAutotrophicRespiration","page":"API Reference","title":"Terra.PALADYNAutotrophicRespiration","text":"struct PALADYNAutotrophicRespiration{NF} <: Terra.AbstractAutotrophicRespiration\n\nAutotrophic respiration implementation from PALADYN (Willeit 2016).\n\nAuthors: Maha Badri and Matteo Willeit\n\nProperties:\n\ncn_sapwood::Any: Sapwood parameter\ncn_root::Any: Root parameter\naws::Any: Ratio of total to respiring stem carbon, Cox 2001, PFT specific [-]\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.PALADYNCarbonDynamics","page":"API Reference","title":"Terra.PALADYNCarbonDynamics","text":"struct PALADYNCarbonDynamics{NF} <: Terra.AbstractVegetationCarbonDynamics\n\nVegetation carbon dynamics implementation following PALADYN (Willeit 2016) but considering only the sum of the vegetation carbon pools. The subsequent splitting into Cleaf, Cstem, C_root is not implemented for now.\n\nAuthors: Maha Badri \n\nProperties:\n\nSLA::Any: Specific leaf area (Kattge et al. 2011) [m¬≤/kgC], PFT specific\nawl::Any: Allometric coefficient, modified from Cox 2001 to account for bwl=1 [kgC/m¬≤], PFT specific\nLAI_min::Any: Minimum Leaf Area Index modified from Clark et al. 2011 [m¬≤/m¬≤], PFT specific\nLAI_max::Any: Maximum Leaf Area Index modified from Clark et al. 2011 [m¬≤/m¬≤], PFT specific\nŒ≥L::Any: Leaf turnover rate (Kattge et al. 2011) [1/year], PFT specific\nŒ≥R::Any: Root turnover rate [1/year], PFT specific\nŒ≥S::Any: Stem turnover rate modified from Clark et al. 2011 [1/year], PFT specific\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.PALADYNPhenology","page":"API Reference","title":"Terra.PALADYNPhenology","text":"struct PALADYNPhenology{NF} <: Terra.AbstractPhenology\n\nVegetation phenology implementation from PALADYN (Willeit 2016).\n\nAuthors: Maha Badri and Matteo Willeit\n\nProperties:\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.PALADYNVegetationDynamics","page":"API Reference","title":"Terra.PALADYNVegetationDynamics","text":"struct PALADYNVegetationDynamics{NF} <: Terra.AbstractVegetationDynamics\n\nVegetation dynamics implementation following PALADYN (Willeit 2016) for a single PFT based on the Lotka‚ÄìVolterra approach.\n\nAuthors: Maha Badri \n\nProperties:\n\nŒΩ_seed::Any: Vegetation seed fraction [-]\nŒ≥v_min::Any: Minimum vegetation disturbance rate [1/year]\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.PrescribedHydraulics","page":"API Reference","title":"Terra.PrescribedHydraulics","text":"PrescribedHydraulics{NF} <: AbstractSoilHydraulicProperties\n\nRepresents a simple case where soil hydraulic properties are directly prescribed to constant values. This is mostly provided just for testing, although it may be useful in certain cases where direct measurements of hydraulic properites are available.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.SURFEXHydraulics","page":"API Reference","title":"Terra.SURFEXHydraulics","text":"struct SURFEXHydraulics{NF} <: Terra.AbstractSoilHydraulicProperties{NF}\n\nSURFEX parameterization of mineral soil porosity (Masson et al. 2013).\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.SoilEnergyBalance","page":"API Reference","title":"Terra.SoilEnergyBalance","text":"struct SoilEnergyBalance{NF, HeatOperator<:Terra.AbstractHeatOperator, ThermalProps<:(SoilThermalProperties{NF})} <: Terra.AbstractSoilEnergyBalance{NF}\n\nProperties:\n\noperator::Terra.AbstractHeatOperator: Heat transport operator\nthermal_properties::SoilThermalProperties: Soil thermal properties\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.SoilModel","page":"API Reference","title":"Terra.SoilModel","text":"struct SoilModel{NF, GridType<:Terra.AbstractLandGrid{NF}, Stratigraphy<:Terra.AbstractStratigraphy, SoilEnergy<:Terra.AbstractSoilEnergyBalance, SoilHydrology<:Terra.AbstractSoilHydrology, Biogeochemistry<:Terra.AbstractSoilBiogeochemistry, Constants<:PhysicalConstants{NF}, BoundaryConditions<:Terra.AbstractBoundaryConditions, Initializer<:Terra.AbstractInitializer, TimeStepper<:Terra.AbstractTimeStepper} <: Terra.AbstractSoilModel{NF}\n\nGeneral implementation of a 1D column model of soil energy, water, and carbon transport.\n\nProperties:\n\ngrid::Terra.AbstractLandGrid: Spatial grid type\nstrat::Terra.AbstractStratigraphy: Stratigraphy of the soil\nenergy::Terra.AbstractSoilEnergyBalance: Soil energy balance\nhydrology::Terra.AbstractSoilHydrology: Soil hydrology/water balance\nbiogeochem::Terra.AbstractSoilBiogeochemistry: Soil biogeochemistry\nconstants::PhysicalConstants: Physical constants\nboundary_conditions::Terra.AbstractBoundaryConditions: Boundary conditions\ninitializer::Terra.AbstractInitializer: State variable initializer\ntime_stepping::Terra.AbstractTimeStepper: Timestepping scheme\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.StateVariables","page":"API Reference","title":"Terra.StateVariables","text":"struct StateVariables{prognames, tendnames, auxnames, subnames, closurenames, ProgVars, TendVars, AuxVars, SubVars, Closures, ClockType} <: Terra.AbstractStateVariables\n\nContainer type for all Fields corresponding to state variables defined by a model. StateVariables partitions the fields into three categories: prognostic, tendencies, and auxiliary. Prognostic variables are those which characterize the state of the system and are assigned tendencies to be integrated by the timestepper. Auxiliary fields are additional state variables derived from the prognostic state variables but which are conditionally independent of their values at the previous time step given the current prognostic state. It is worth noting that tendencies are also treated internally as auxiliary variables; however, they are assigned their own category here since they need to be handled separately by the timestepping scheme.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.TemperatureEnergyClosure","page":"API Reference","title":"Terra.TemperatureEnergyClosure","text":"TemperatureEnergyClosure\n\nDefines the constitutive relationship between temperature and the internal energy, U, of the system, i.e:\n\nU(T) = Ttimes C(T) - L_f theta_wi (1 - F(T))\n\nwhere T is temperature, C(T) is the temperature-dependent heat capacity, L_f is the volumetric latent heat of fusion, and F(T) is the constitutive relation between temperature and the unfrozen fraction of pore water. Note that this formulation implies that the zero\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.VegetationModel","page":"API Reference","title":"Terra.VegetationModel","text":"struct VegetationModel{NF, Photosynthesis<:Terra.AbstractPhotosynthesis, StomatalConducatance<:Terra.AbstractStomatalConductance, AutotrophicRespiration<:Terra.AbstractAutotrophicRespiration, CarbonDynamics<:Terra.AbstractVegetationCarbonDynamics, VegetationDynamics<:Terra.AbstractVegetationDynamics, Phenology<:Terra.AbstractPhenology, GridType<:Terra.AbstractLandGrid{NF}, Constants<:PhysicalConstants{NF}, BoundaryConditions<:Terra.AbstractBoundaryConditions, Initializer<:Terra.AbstractInitializer, TimeStepper<:Terra.AbstractTimeStepper} <: Terra.AbstractVegetationModel{NF}\n\nModel for natural (unmanaged) vegetation processes for a single plant functional type (PFT). Multiple PFTs can be later handled with a TiledVegetationModel type that composes multiple VegetationModels with different parameters for each PFT.\n\nProperties:\n\ngrid::Terra.AbstractLandGrid: Spatial grid type\nphotosynthesis::Terra.AbstractPhotosynthesis: Photosynthesis scheme\nstomatal_conductance::Terra.AbstractStomatalConductance: Stomatal conducantance scheme\nautotrophic_respiration::Terra.AbstractAutotrophicRespiration: Autotrophic respiration scheme\nphenology::Terra.AbstractPhenology: Phenology scheme\ncarbon_dynamics::Terra.AbstractVegetationCarbonDynamics: Vegetation carbon pool dynamics\nvegetation_dynamics::Terra.AbstractVegetationDynamics: Vegetation population density or coverage fraction dynamics\nconstants::PhysicalConstants: Physical constants\nboundary_conditions::Terra.AbstractBoundaryConditions: Boundary conditions\ninitializer::Terra.AbstractInitializer: State variable initializer\ntime_stepping::Terra.AbstractTimeStepper: Timestepping scheme\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.XY","page":"API Reference","title":"Terra.XY","text":"XY <: VarDims\n\nIndicator type for variables that should be assigned a 2D (lateral only) field on their associated grid.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.XYZ","page":"API Reference","title":"Terra.XYZ","text":"XYZ <: VarDims\n\nIndicator type for variables that should be assigned a 3D field on their associated grid.\n\n\n\n\n\n","category":"type"},{"location":"api_reference/#Terra.auxiliary-Tuple{Symbol, Terra.VarDims}","page":"API Reference","title":"Terra.auxiliary","text":"auxiliary(name, dims)\n\n\nConvenience constructor method for AuxiliaryVariable.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_APAR-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, NF, NF}} where NF","page":"API Reference","title":"Terra.compute_APAR","text":"compute_APAR(photo, swdown, LAI)\n\n\nComputes absorbed PAR limited by the fraction of PAR assimilated at ecosystem level APAR [mol/m¬≤/day], Eq. 62, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Ag-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, Vararg{NF, 5}}} where NF","page":"API Reference","title":"Terra.compute_Ag","text":"compute_Ag(photo, c_1, c_2, APAR, Vc_max, Œ≤)\n\n\nComputes the daily gross photosynthesis Ag [gC/m¬≤/day], Eqn 2, Haxeltine & Prentice 1996\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_And-Union{Tuple{NF}, Tuple{LUEPhotosynthesis, Vararg{NF, 6}}} where NF","page":"API Reference","title":"Terra.compute_And","text":"compute_And(photo, c_1, c_2, APAR, Vc_max, Œ≤, Rd)\n\n\nComputes the total daytime net photosynthesis And [gC/m¬≤/day], Eqn 19, Haxeltine & Prentice 1996 + Eq. 65, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_C_veg_tend-Union{Tuple{NF}, Tuple{PALADYNCarbonDynamics{NF}, NF, NF}} where NF","page":"API Reference","title":"Terra.compute_C_veg_tend","text":"compute_C_veg_tend(vegcarbon_dynamics, LAI_b, NPP)\n\n\nComputes the C_veg tendency based on NPP and the balanced Leaf Area Index LAI_b, Eq. 72, PALADYN (Willeit 2016) \n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_JE_JC-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, Vararg{NF, 4}}} where NF","page":"API Reference","title":"Terra.compute_JE_JC","text":"compute_JE_JC(photo, c_1, c_2, APAR, Vc_max)\n\n\nComputes the PAR-limited and the rubisco-activity-limited photosynthesis rates JE and JC [gC/m¬≤/day], Eqn 3+5, Haxeltine & Prentice 1996.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_LAI-Union{Tuple{NF}, Tuple{PALADYNPhenology{NF}, NF}} where NF","page":"API Reference","title":"Terra.compute_LAI","text":"compute_LAI(phenol, LAI_b)\n\n\nComputes LAI, based on the balanced Leaf Area Index LAI_b:\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_NPP-Tuple{PALADYNAutotrophicRespiration, Any, Any}","page":"API Reference","title":"Terra.compute_NPP","text":"compute_NPP(autoresp, GPP, Ra)\n\n\nComputes Net Primary Productivity NPP as the difference between Gross Primary Production GPP and autotrophic respiration Ra in [kgC/m¬≤/day].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_PAR-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, NF}} where NF","page":"API Reference","title":"Terra.compute_PAR","text":"compute_PAR(photo, swdown)\n\n\nComputes NET Photosynthetically Active Radiation PAR [mol/m¬≤/day].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Ra-Tuple{PALADYNAutotrophicRespiration, PALADYNCarbonDynamics, Vararg{Any, 5}}","page":"API Reference","title":"Terra.compute_Ra","text":"compute_Ra(\n    autoresp,\n    vegcarbon_dynamics,\n    T_air,\n    Rd,\n    phen,\n    C_veg,\n    GPP\n)\n\n\nComputes autotrophic respiration Ra as the sum of maintenance respiration Rm and growth respiration Rg in [kgC/m¬≤/day].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Rd-Tuple{LUEPhotosynthesis, Any, Any}","page":"API Reference","title":"Terra.compute_Rd","text":"compute_Rd(photo, Vc_max, Œ≤)\n\n\nComputes the daily leaf respiration Rd [gC/m¬≤/day], Eqn 10, Haxeltine & Prentice 1996 and Eq. 10 PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Rg-Union{Tuple{NF}, Tuple{PALADYNAutotrophicRespiration{NF}, Any, Any}} where NF","page":"API Reference","title":"Terra.compute_Rg","text":"compute_Rg(autoresp, GPP, Rm)\n\n\nComputes growth respiration Rg in [kgC/m¬≤/day].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Rm-Union{Tuple{NF}, Tuple{PALADYNAutotrophicRespiration{NF}, PALADYNCarbonDynamics{NF}, Vararg{Any, 4}}} where NF","page":"API Reference","title":"Terra.compute_Rm","text":"compute_Rm(\n    autoresp,\n    vegcarbon_dynamics,\n    T_air,\n    Rd,\n    phen,\n    C_veg\n)\n\n\nComputes maintenance respiration Rm in [kgC/m¬≤/day].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Vc_max-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, Vararg{NF, 7}}} where NF","page":"API Reference","title":"Terra.compute_Vc_max","text":"compute_Vc_max(\n    photo,\n    c_1,\n    APAR,\n    Kc,\n    Ko,\n    Œì_star,\n    pres_i,\n    pres_O2\n)\n\n\nComputes the maximum daily rate of net photosynthesis Vc_max [gC/m¬≤/day], following the coordination hypothesis (acclimation), see Harrison 2021 Box 2. Note: this is not the same formula in PALADYN paper, this implementaion is taken from the code\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_auxiliary!","page":"API Reference","title":"Terra.compute_auxiliary!","text":"compute_auxiliary!(state, model::AbstractModel)\n\nComputes updates to all auxiliary variables based on the current prognostic state of the model.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.compute_auxiliary!-Tuple{Any, Any, Any, Terra.AbstractLandProcess, Vararg{Any}}","page":"API Reference","title":"Terra.compute_auxiliary!","text":"compute_auxiliary!(idx, state, model, process, args)\n\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_c1_c2-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, Vararg{NF, 6}}} where NF","page":"API Reference","title":"Terra.compute_c1_c2","text":"compute_c1_c2(photo, T_air, Œì_star, Kc, Ko, pres_i, pres_O2)\n\n\nComputes factor for light-limited assimilation c_1 and factor for RuBisCO-limited assimilation c_2, Eqs. C4+C5, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_f_deciduous-Union{Tuple{PALADYNPhenology{NF}}, Tuple{NF}} where NF","page":"API Reference","title":"Terra.compute_f_deciduous","text":"compute_f_deciduous(phenol)\n\n\nComputes f_deciduous, a factor for smooth transition between evergreen and deciduous [-].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_phen-Union{Tuple{PALADYNPhenology{NF}}, Tuple{NF}} where NF","page":"API Reference","title":"Terra.compute_phen","text":"compute_phen(phenol)\n\n\nComputes phen, the phenology factor [-].\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_photosynthesis-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, Vararg{NF, 6}}} where NF","page":"API Reference","title":"Terra.compute_photosynthesis","text":"compute_photosynthesis(\n    photo,\n    T_air,\n    swdown,\n    pres,\n    co2,\n    LAI,\n    Œªc\n)\n\n\nComputes Gross Primary Production GPPin [kgC/m¬≤/day] and leaf respiration Rd in [gC/m¬≤/day]\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_pres_i-Tuple{LUEPhotosynthesis, Any, Any}","page":"API Reference","title":"Terra.compute_pres_i","text":"compute_pres_i(photo, Œªc, pres_a)\n\n\nComputes intercellular CO2 partial pressure [Pa], Eq. 67, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_resp10-Union{Tuple{PALADYNAutotrophicRespiration{NF}}, Tuple{NF}} where NF","page":"API Reference","title":"Terra.compute_resp10","text":"compute_resp10(autoresp)\n\n\nComputes resp10 \n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_tendencies!","page":"API Reference","title":"Terra.compute_tendencies!","text":"compute_tendencies!(state, model::AbstractModel)\n\nComputes tendencies for all prognostic state variables for model stored in the given state.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.compute_tendencies!-Tuple{Any, Any, Any, Terra.AbstractLandProcess, Vararg{Any}}","page":"API Reference","title":"Terra.compute_tendencies!","text":"compute_tendencies!(idx, state, model, process, args)\n\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_vpd-Union{Tuple{NF}, Tuple{NF, NF, NF}} where NF","page":"API Reference","title":"Terra.compute_vpd","text":"compute_vpd(T_air, q_air, pres)\n\n\nComputes the vapor pressure deficit from air temperature, specific humidity, and surface pressure.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œì_star-Union{Tuple{NF}, Tuple{LUEPhotosynthesis{NF}, NF, NF}} where NF","page":"API Reference","title":"Terra.compute_Œì_star","text":"compute_Œì_star(photo, œÑ, pres_O2)\n\n\nComputes the CO2 compensation point Œì_star, Eq. C6, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œõ_loc-Union{Tuple{NF}, Tuple{PALADYNCarbonDynamics{NF}, Any}} where NF","page":"API Reference","title":"Terra.compute_Œõ_loc","text":"compute_Œõ_loc(vegcarbon_dynamics, LAI_b)\n\n\nComputes the local litterfall rate Œõ_loc based on the balanced Leaf Area Index LAI_b (assuming evergreen PFTs), Eq. 75, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œ≤-Union{Tuple{LUEPhotosynthesis{NF}}, Tuple{NF}} where NF","page":"API Reference","title":"Terra.compute_Œ≤","text":"compute_Œ≤(photo)\n\n\nComputes the soil-moisture limiting factor Œ≤, Eq. 66, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œ≥v-Tuple{PALADYNVegetationDynamics}","page":"API Reference","title":"Terra.compute_Œ≥v","text":"compute_Œ≥v(veg_dynamics)\n\n\nComputes the disturbance rateŒ≥v, Eq. 80, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œª_NPP-Union{Tuple{NF}, Tuple{PALADYNCarbonDynamics{NF}, Any}} where NF","page":"API Reference","title":"Terra.compute_Œª_NPP","text":"compute_Œª_NPP(vegcarbon_dynamics, LAI_b)\n\n\nComputes Œª_NPP,a factor determining the partitioning of NPP between increase of vegetation carbon of the existing  vegetated area and spreading of the given PFT based on the balanced Leaf Area Index LAI_b, Eq. 74, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_Œªc-Union{Tuple{NF}, Tuple{MedlynStomatalConductance{NF}, Any}} where NF","page":"API Reference","title":"Terra.compute_Œªc","text":"compute_Œªc(stomcond, vpd)\n\n\nComputes the ratio of leaf-internal and air CO2 concentration Œªc,  derived from the optimal stomatal conductance model (Medlyn et al. 2011), Eq. 71, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_ŒΩ_star-Tuple{PALADYNVegetationDynamics, Any}","page":"API Reference","title":"Terra.compute_ŒΩ_star","text":"compute_ŒΩ_star(veg_dynamics, ŒΩ)\n\n\nComputes ŒΩ_star which is the maximum between the current vegetation fraction ŒΩ and the seed fraction ŒΩ_seed [-], to ensure that a PFT is always seeded.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.compute_ŒΩ_tend-Union{Tuple{NF}, Tuple{PALADYNVegetationDynamics, PALADYNCarbonDynamics{NF}, NF, NF, NF}} where NF","page":"API Reference","title":"Terra.compute_ŒΩ_tend","text":"compute_ŒΩ_tend(\n    veg_dynamics,\n    vegcarbon_dynamics,\n    LAI_b,\n    C_veg,\n    ŒΩ\n)\n\n\nComputes the vegetation fraction tendency for a single PFT, Eq. 73, PALADYN (Willeit 2016).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.create_field-Tuple{Terra.AbstractVariable, Terra.AbstractInitializer, Terra.AbstractBoundaryConditions, Terra.AbstractLandGrid, Vararg{Any}}","page":"API Reference","title":"Terra.create_field","text":"create_field(var, init, bcs, grid, args; kwargs...)\n\n\nInitializes a Field on grid for the variable, var, using the given initializer, init, and boundary conditions, bcs. Additional arguments are passed direclty to the Field constructor. The location of the Field is determined by the specified VarDims on var.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.fastmap-Union{Tuple{F}, Tuple{F, Vararg{NamedTuple}}} where F","page":"API Reference","title":"Terra.fastmap","text":"fastmap(f::F, iter::NamedTuple...) where {F}\n\nSame as map for NamedTuples but with guaranteed type stability. fastmap is a @generated function which unrolls calls to f into a loop-free tuple construction expression. All named tuples must have the same keys but in no particular order. The returned NamedTuple \n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.fastmap-Union{Tuple{N}, Tuple{F}, Tuple{F, Vararg{Tuple{Vararg{Any, N}}}}} where {F, N}","page":"API Reference","title":"Terra.fastmap","text":"fastmap(f::F, iter::NTuple{N,Any}...) where {F,N}\n\nSame as map for NTuples but with guaranteed type stability. fastmap is a @generated function which unrolls calls to f into a loop-free tuple construction expression.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_boundary_conditions-Tuple{Terra.AbstractModel}","page":"API Reference","title":"Terra.get_boundary_conditions","text":"get_boundary_conditions(model::AbstractModel)::AbstractBoundaryConditions\n\nReturns the time stepping scheme associated with this model.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_dt","page":"API Reference","title":"Terra.get_dt","text":"get_dt(timestepper::AbstractTimeStepper)\n\nGet the current timestep size for the time stepper.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.get_field_boundary_conditions-Tuple{Terra.AbstractBoundaryConditions, Terra.AbstractVariable, Terra.AbstractLandGrid}","page":"API Reference","title":"Terra.get_field_boundary_conditions","text":"get_field_boundary_conditions(bcs::AbstractBoundaryConditions, var::AbstractVariable)\n\nRetrieve the Field boundary conditions for the corresponding variable. Defaults to returning nothing if no BC is defined.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_field_grid-Tuple{ColumnGrid}","page":"API Reference","title":"Terra.get_field_grid","text":"get_field_grid(grid)\n\n\nRetrieves the underlying numerical grid on which Fields are defined.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_field_initializer-Tuple{FieldInitializers, Terra.AbstractVariable}","page":"API Reference","title":"Terra.get_field_initializer","text":"get_field_initializer(init, var)\n\n\nRetrieves the initializer for the given variable var or returns nothing if not defined.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_field_initializer-Tuple{Terra.AbstractInitializer, Terra.AbstractVariable}","page":"API Reference","title":"Terra.get_field_initializer","text":"get_field_initializer(init::AbstractInitializer, var::AbstractVariable)\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_grid-Tuple{Terra.AbstractModel}","page":"API Reference","title":"Terra.get_grid","text":"get_grid(model::AbstractModel)::AbstractGrid\n\nReturn the spatial grid associated with this model.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_initializer-Tuple{Terra.AbstractModel}","page":"API Reference","title":"Terra.get_initializer","text":"get_initializer(model::AbstractModel)::AbstractInitializer\n\nReturns the time stepping scheme associated with this model.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_npoints-Tuple{Terra.AbstractVerticalSpacing}","page":"API Reference","title":"Terra.get_npoints","text":"get_npoints(spacing)\n\n\nReturn the number of vertical layers defined by this discretization.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_spacing-Tuple{Terra.AbstractVerticalSpacing}","page":"API Reference","title":"Terra.get_spacing","text":"get_spacing(spacing)\n\n\nReturn a Vector of vertical layer thicknesses according to the given discretization.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.get_time_stepping-Tuple{Terra.AbstractModel}","page":"API Reference","title":"Terra.get_time_stepping","text":"get_time_stepping(model::AbstractModel)::AbstractTimeStepper\n\nReturns the time stepping scheme associated with this model.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.heatcapacity-Tuple{SoilThermalProperties, NamedTuple}","page":"API Reference","title":"Terra.heatcapacity","text":"heatcapacity(props, fracs)\n\n\nComputes the bulk heat capacity of a finite volume from the given volumetric fractions.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.initialize!","page":"API Reference","title":"Terra.initialize!","text":"initialize!(state, model::AbstractModel)\ninitialize!(state, model::AbstractModel, initializer::AbstractInitializer)\n\nCalls initialize! on the model and its corresponding initializer. This method only needs to be implemented if initialization routines are necessary in addition to direct field/variable initializers.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.is_adaptive","page":"API Reference","title":"Terra.is_adaptive","text":"is_adaptive(timestepper::AbstractTimeStepper)\n\nReturns true if the given time stepper is adaptive, false otherwise.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.merge_duplicates-Tuple{Tuple}","page":"API Reference","title":"Terra.merge_duplicates","text":"merge_duplicates(values::Tuple)\n\nFilters out duplicates from the given tuple. Note that this method is not type stable or allocation-free!\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.namespace-Tuple{Symbol}","page":"API Reference","title":"Terra.namespace","text":"namespace(name)\n\n\nConvenience constructor method for Namespace provided only for consistency.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.organic_fraction-Tuple{Any, Any, ConstantSoilCarbonDenisty}","page":"API Reference","title":"Terra.organic_fraction","text":"organic_fraction(idx, state, bgc::ConstantSoilCarbonDenisty)\n\nCalculate the soil organic carbon fraction at the given grid index. For ConstantSoilCarbonDenisty, this simply returns a constant parameter. Implementations of soil carbon dynamics would want to compute this based on the prognostic state of the carbon content/pool stored in the soil.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.organic_fraction-Tuple{ConstantSoilCarbonDenisty}","page":"API Reference","title":"Terra.organic_fraction","text":"organic_fraction(bgc::ConstantSoilCarbonDenisty)\n\nCalculate the organic solid fraction based on the prescribed SOC and natural porosity/density of the organic material.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.organic_porosity-Tuple{ConstantSoilCarbonDenisty}","page":"API Reference","title":"Terra.organic_porosity","text":"organic_porosity(bgc::ConstantSoilCarbonDenisty)\n\nGet the prescribed natural porosity of organic soil.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.partial_pressure_CO2-Union{Tuple{NF}, Tuple{NF, NF}} where NF","page":"API Reference","title":"Terra.partial_pressure_CO2","text":"partial_pressure_CO2(pres, conc_co2)\n\n\nCompute partial pressure of CO2 from surface pressure and CO2 concentration in Pa.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.partial_pressure_O2-Tuple{NF} where NF","page":"API Reference","title":"Terra.partial_pressure_O2","text":"partial_pressure_O2(pres)\n\n\nCompute partial pressure of oxygen from surface pressure in Pa.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.prognostic-Tuple{Symbol, Terra.VarDims}","page":"API Reference","title":"Terra.prognostic","text":"prognostic(name, dims)\n\n\nConvenience constructor method for PrognosticVariable.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.run!-Tuple{Simulation}","page":"API Reference","title":"Terra.run!","text":"run!(sim; steps, period, dt)\n\n\nRun the simulation by steps or a period with dt timestep size (in seconds or Dates.Period).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.thermalconductivity-Tuple{SoilThermalProperties, NamedTuple}","page":"API Reference","title":"Terra.thermalconductivity","text":"thermalconductivity(props, fracs)\n\n\nComputes the bulk thermal conductivity of a finite volume from the given volumetric fractions.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.timestep!","page":"API Reference","title":"Terra.timestep!","text":"timestep!(state, model::AbstractModel, timestepper::AbstractTimeStepper, [dt = nothing])\n\nAdvance the model state by one time step, or by dt units of time.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.timestep!-Tuple{Any, Terra.AbstractModel, Any}","page":"API Reference","title":"Terra.timestep!","text":"Convenience dispatch for timestep! that forwards to timestep!(state, model, get_time_stepping(model), dt).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.timestep!-Tuple{Simulation}","page":"API Reference","title":"Terra.timestep!","text":"timestep!(sim)\n\n\nAdvance the simulation forward by one timestep.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.tuplejoin-Tuple{}","page":"API Reference","title":"Terra.tuplejoin","text":"tuplejoin([x, y], z...)\n\nConcatenates one or more tuples together.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.vardims-Tuple{Terra.AbstractVariable}","page":"API Reference","title":"Terra.vardims","text":"vardims(::AbstractVariable)\n\nRetrieves the grid dimensions on which this variable is defined.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#Terra.variables","page":"API Reference","title":"Terra.variables","text":"variables(model::AbstractModel)\n\nReturn a Tuple of AbstractVariables (i.e. PrognosticVariable, AuxiliaryVariable, etc.) defined by the model. For models that consist of one or more sub-models, variables may optionally be grouped into namespaces by returning a NamedTuple where the keys correspond to the group names.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Terra.varname-Tuple{Terra.AbstractVariable}","page":"API Reference","title":"Terra.varname","text":"varname(::AbstractVariable)\nvarname(::AbstractClosureRelation)\nvarname(::Pair{Symbol})\n\nRetrieves the name of the given variable or closure. For closure relations, varname should return the name of the variable returned by the closure relation.\n\n\n\n\n\n","category":"method"},{"location":"physics/vegetation/#Vegetation","page":"Vegetation","title":"Vegetation","text":"","category":"section"},{"location":"physics/vegetation/","page":"Vegetation","title":"Vegetation","text":"warning: Warning\nThis page is a work in progress. If you have any questions or notice any errors, please raise an issue.","category":"page"},{"location":"physics/vegetation/","page":"Vegetation","title":"Vegetation","text":"Coming soon!","category":"page"},{"location":"overview/mathematical_formulation/#Mathematical-formulation","page":"Mathematical formulation","title":"Mathematical formulation","text":"","category":"section"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"Terra.jl strictly follows a philosophy of dynamical modeling via discretized differential equations. This means that all physical processes in the model must be written as terms in a set of continuous-time equations of the form:","category":"page"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"fracpartial u(xt)partial t = G(u(xt)) + F(xt)","category":"page"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"where u(xt) is a field describing the prognostic state of the system, t is time, F is a focing term, and G is a (differentiable) function which computes the tendencies, i.e. the change in the prognostic state at the current time, t.","category":"page"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"In many areas of science and engineering, this approach to modeling is fairly standard. It can be contrasted, however, with discrete-time dynamical modeling where state changes are computed according to a series of discrete update rules, mathbfD, with some fixed time resolution, i.e:","category":"page"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"mathbfu_t+1 = mathbfD(mathbfu_t)","category":"page"},{"location":"overview/mathematical_formulation/#Practical-implications","page":"Mathematical formulation","title":"Practical implications","text":"","category":"section"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"While the above modeling philosophy has many advantages, it also places some practical restrictions on how we code the model physics. The most important constraints are:","category":"page"},{"location":"overview/mathematical_formulation/","page":"Mathematical formulation","title":"Mathematical formulation","text":"Prognostic (i.e. time-integrated) state variables must be clearly and coherently distinguished from all other auxiliary variables derived from the prognostic state.\nPrognostic variables of the system should only be updated by the timestepper (or callback) and should not be otherwise modified by the physical processes within a single timestep. Note that this effectively rules out all classical ‚Äúbucket schemes‚Äù for soil hydrology which rely on non-physical, instantaneous routing of water between soil layers.\nFor physical coherence, tendencies must be computed only based on the current state of the system. Similarly, all non-prognostic (auxiliary) variables should be derived only from the prognostic state and/or forcings; they should not depend on non-prognostic values from previous timesteps, except in special cases where previous values are used only for computational efficiency (e.g. iterative solvers).","category":"page"},{"location":"contributing/#Contributing","page":"Contributing","title":"Contributing","text":"","category":"section"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"We gladly welcome any and all contributions to Terra.jl. Building a new land model is a huge undertaking that no single developer or scientist can hope to achieve alone. Collaboration always has been and always will be key to building good geoscientific models. Terra is no exception to this, and its success will depend on the contributions of the broader community.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"There are multiple ways in which you could consider contributing to the project:","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"If you have a question or an idea, raise an issue or start a discussion on the GitHub repository.\nIf you want to try implementing something, clone the repository and make a pull request. Please take note of our Software development practices below.\nIf you're not able to directly contribute yet but would like to support our work, consider sharing the GitHub repository (or this documentation) with others who you think might be interested.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"Regardless of how you choose to contribute, we thank you for your participation, and we look forward to working with you!","category":"page"},{"location":"contributing/#Software-development-practices","page":"Contributing","title":"Software development practices","text":"","category":"section"},{"location":"contributing/#Automated-testing-and-continuous-integration","page":"Contributing","title":"Automated testing and continuous integration","text":"","category":"section"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"Terra.jl adheres to software development standards for automated testing via continuous integration. We write unit tests for every function of our model. In some cases this might appear trivial, but we still want to achieve a near complete coverage of our code in the tests. The majority of the tests should cover the smallest possible units over different input arguments and types (if applicable). Unit tests should typically call the tested functions in a way that is representative for their use in the model, but try to reduce the computational complexity (e.g. by choosing very low dimensional inputs) to keep the overall CI time manageable. Additionally, we have some tests that ensure top-level functionality and stability of the model as well. Every additional proposed feature in a Pull Request has to come with unit tests. Tests verifying differentiability and GPU compatibility will also be requried.","category":"page"},{"location":"contributing/#Kernel-programming","page":"Contributing","title":"Kernel programming","text":"","category":"section"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"Terra.jl is a device-agnostic model that runs on CPUs and GPUs by using KernelAbstractions.jl. This means that most computations need to be implemented within kernel functions that follow KernelAbstractions‚Äô syntax. Each thread in the CPU or GPU will then compute the discretized equations for a single grid point.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"For writing kernels we follow a strategy closely inspired by Oceaninanigans.jl: we want to fuse kernels as much as possible. Kernel fusion means that in practice we write very ‚Äúlarge‚Äù kernels that fuse as many operations as possible together in one kernel. Kernel fusion leads to more efficient GPU computations, especially by reducing memory demand (Wang et. al 2000). In order to still keep our code well structured and modular, our approach relies on implementing most processes as inlined functions that can be called from a GPU kernel. We have not yet found any significant limitations to this approach.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"How this looks in action in Terra.jl you can already see in the prototype code, e.g. for the SoilEnergyBalance: There compute_tendencies! is the mandatory function for the model component, it launches exactly one kernel compute_energy_tendency!, which includes several @inline function to compute individual contributions to the energy balance such as energy_tendency, thermalconductivity and the diffusive_heat_flux.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"It's also worth checking out the Simulation tips provided in the documentation for Oceananigans.","category":"page"},{"location":"contributing/#Automatic-Differentiation-with-Enzyme","page":"Contributing","title":"Automatic Differentiation with Enzyme","text":"","category":"section"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"For AD, we rely primarily on reverse mode differentiation via Enzyme.jl. In contrast to many other AD systems, Enzyme doesn‚Äôt put particularly strong restrictions on coding style. For example, Array mutations are not only allowed, they are even encouraged!","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"There is one thing however, that is crucial for Enzyme to work: type stability. The code absolutely has to be type stable, even in parts that are performance non-critical. Every occurrence of type instability may break differentiability with Enzyme. If this happens, we recommend first quickly checking for type instability of core function calls using @code_warntype and @inferred in unit tests. Then, if the issue is not yet apparent, debug the code using Cthulhu.jl. Cthulhu is an awesome tool to interactively inspect your code for type instabilities and it is extremely easy to run: just preempt the function that you are trying to differentiate with @descend after loading the Cthulhu package.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"Enzyme does, however, have some disadvantages; it is still not fully mature and bugs do occur. As of the time of writing (August 2025), this is especially the case for Julia 1.11. We currently recommend staying on Julia 1.10.10 (LTS) for the time being. Other cryptic Enzyme error messages have become rarer with time, but they do still occasionally happen. In these cases, we, along with our AD team led by Valentin in the DELTA-ESM project, are happy to offer support to the best of our abilities.","category":"page"},{"location":"#Terra.jl","page":"Home","title":"Terra.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Terra.jl is a new and upcoming land model that aims to support hybrid physics- and data-driven land modeling across multiple spatial and temporal scales. We envision Terra to be part of a new generation of Earth system component models that combine modularity, interactivity, GPU-compability and auto-differentiability (AD) for seamless integration of process-based and data-driven model components in both global and regional scale simulations.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Terra is being developed alongside SpeedyWeather.jl and Oceananigans.jl as the land component of the proposed DELTA-ESM project which aims to realize this vision by building a new, user-friendly, and fully GPU/AD-compatible Earth System Model in the Julia programming language.","category":"page"},{"location":"","page":"Home","title":"Home","text":"warning: üößüöß Under construction üößüöß\nThis is an early prototype of our model and is not production-ready. Expect things to change rapidly and break often. If you share our vision for a new paradigm of Earth system modeling and would like to get involved in the project, don‚Äôt hesitate to reach out by creating an issue on GitHub issues or sending us an email. We are always happy to welcome new collaborators!","category":"page"},{"location":"#Table-of-contents","page":"Home","title":"Table of contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n    \"overview/mathematical_formulation.md\",\n    \"overview/software_architecture.md\",\n    \"api_reference.md\",\n]\nDepth = 3","category":"page"}]
}
